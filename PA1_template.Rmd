---
title: "Assignment-Activity Monitoring"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(plyr)

```

## R Markdown

This is a R Markdown document for the assignment titled Activity Monitoring. The Markdown document code will perform the required analysis and output as an html file.

### Code to read in data
This portion of the code reads in data and remove NA values to give the total number of steps and perform simple statistical analysis such as the mean and median steps in a day. 

```{r readindata}
rawdata<-read.csv("activity.csv",sep=",")
rawdata_NA<-na.omit(rawdata)

```

### Code to summarize the data, taking mean, median and sum of steps taken
This portion of the code summarizes the data. The total steps per day is computed and an histogram is calculated.
```{r procmean}
date_sum<-ddply(rawdata_NA,~date,summarise,sum=sum(steps))
mediandata<-median(date_sum$sum)
meandata<-mean(date_sum$sum)
interval_mean<-ddply(rawdata_NA,~interval,summarise,mean=mean(steps))
```
**The mean for the total number of steps taken in a day is `r meandata` and the median steps is `r mediandata`**


### Plot of total steps taken in a day.

```{r historgram, fig.width=13,fig.height=5,echo=FALSE}

barplot(date_sum$sum,width=0.05,names.arg=date_sum$date,xlab="date",ylab="No of Steps")
axis.Date(1,at=date_sum$date)
```

### Plot of steps for time interval averaged over all the dates.
```{r intervalhist, fig.width=13,fig.height=5,echo=FALSE}
#barplot(interval_mean$mean,names.arg=interval_mean$interval,xlab="Interval",ylab="No of Steps")
plot(interval_mean$interval,interval_mean$mean,type='n',xlab='Interval',ylab='No of steps')
lines(interval_mean$interval,interval_mean$mean)
```

### This portion of code calculates the time interval for which the number of steps is maximum 

This portion finds the time interval for which the average number of steps is maximum

```{r timeinter}
ini<-which.max(interval_mean$mean)
timemax<-interval_mean$interval[ini]
```

**The time interval for which the maximum of steps taken is `r timemax`.**

### This portion of the code cacluates the number of NA values

 ```{r diffrows}
 ori<-dim(rawdata)
 mis<-dim(rawdata_NA)
 totalrow<-ori[1]-mis[1]
```

**The total number of rows with NA is `r totalrow`. **

### This portion of code substitue the NA values with mean values

indica<-data.frame(which(is.na(rawdata)))


for (i in 1:nrow(indica))
{
print(indica[i,1])
}
}
